var timeoutRobot;

var Party = {
    isPlaying : false,
    capsPerTurn : 3,
    lives : 10,
    create : function(){
        this.isPlaying = true;
        Viensla.score = 0;
        Player.score = 0;


        this.plplay();

    },
    vlplay : function(){

        if(Viensla.launched < Party.capsPerTurn && !Player.isPlaying){

            $vlpart.find('.capsstock span').eq(Viensla.launched).hide();

            Viensla.isPlaying = true;
            Player.isPlaying = false;

            Viensla.launchCaps();

            timeoutRobot = setTimeout(function(){
                Party.vlplay();
            }, 3000);



        }else{

            clearTimeout(timeoutRobot);

            console.log('Viens la no more caps !');

            Player.launched = 0;

            Party.plplay();

        }

    },
    plplay : function(){

        if(Player.launched < Party.capsPerTurn && !Viensla.isPlaying){
            $plpart.find('.capsstock span').eq(Player.launched).hide();

            clearTimeout(timeoutRobot);

            globalDirection = 1;
            create_caps('pl');


            Player.isPlaying = true;
            Viensla.isPlaying = false;

            if(Player.launched == Party.capsPerTurn-1){
                console.log('viens la attack')
                Viensla.launched = 0;
                Player.isPlaying = false;

                Party.vlplay();
            }
        }else{

            Player.isPlaying = false;

            console.log('Player no more caps !');

            Viensla.launched = 0;

            Party.vlplay();

        }

    },

    vlcaps : function(){


        Viensla.score++;
        Player.lives--;

        clearTimeout(timeoutRobot);



        Viensla.isPlaying = false;

        capsm();

        Party.resetStocks();


        $vlpart.find('.score').text(Viensla.score);

        setTimeout(function(){

            Player.generateCaps();
            Party.plplay();


        }, 1000);

    },


    plcaps : function(){

        Player.score++;
        Viensla.lives--;
        Player.isPlaying = false;

        capsm();

        $plpart.find('.score').text(Player.score);


        Party.resetStocks();

        setTimeout(function(){

            Viensla.generateCaps();
            Party.vlplay();

        }, 1000);

    },

    resetStocks : function(){

        $('.capsstock span').show();

        Viensla.launched = 0;

        Player.launched = 0;

    }

}


function capsm(){
    $('#caps-m').show();
    setTimeout(function(){
        $('#caps-m').hide();
    }, 1000);

    if(!Sounds.mute) Sounds.pschit2.play();

}